---
title: Recovery Dashboard
category: security
priority: 6
---

# Recovery Dashboard Specifications

This document provides detailed specifications for the in-app recovery management dashboard used by organisation owners and platform administrators.

## Overview

The Recovery Dashboard is an administrative interface for managing encryption key recovery requests. It provides:

- Real-time view of pending recovery requests
- Identity verification document review
- Dual authorization workflow management
- Time delay monitoring
- Complete audit trail viewing
- Recovery rate monitoring and alerting
- SIEM integration status

## User Roles and Access

| Role | Dashboard Access | Capabilities |
|------|-----------------|--------------|
| **Team Member** | None | Cannot access dashboard |
| **Team Admin** | Limited | View own team's recoveries (read-only) |
| **Organisation Owner** | Full (org scope) | Manage all org recovery requests |
| **Platform Admin** | Full (all) | Manage all recovery requests + system settings |

## Dashboard Views

### 1. Recovery Requests Overview

**URL**: `/admin/recovery/`

**Purpose**: Main dashboard showing all recovery requests

#### Layout

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ Recovery Dashboard                                    [Export] [Refresh]โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                                         โ
โ  โโโโโโโโโโโโ  โโโโโโโโโโโโ  โโโโโโโโโโโโ  โโโโโโโโโโโโ  โโโโโโโโโโโโ  โ
โ  โ    2     โ  โ    1     โ  โ    3     โ  โ    5     โ  โ   0.3%   โ  โ
โ  โ Pending  โ  โ Awaiting โ  โ In Time  โ  โ Completedโ  โ Recovery โ  โ
โ  โ Requests โ  โ Approval โ  โ  Delay   โ  โ (30 days)โ  โ   Rate   โ  โ
โ  โโโโโโโโโโโโ  โโโโโโโโโโโโ  โโโโโโโโโโโโ  โโโโโโโโโโโโ  โโโโโโโโโโโโ  โ
โ                                                                         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ Filters: [Status โผ] [Date Range โผ] [User โผ] [Team โผ] [Search...]       โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                                         โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ  โ ๐ก AWAITING SECONDARY APPROVAL                                   โ   โ
โ  โ Dr. Sarah Jones (s.jones@nhs.uk)                                โ   โ
โ  โ Survey: Diabetes Audit 2025                                      โ   โ
โ  โ Submitted: 30 Nov 2025, 14:30 โข Request ID: ABC-123-XYZ         โ   โ
โ  โ                                                                   โ   โ
โ  โ Verification: โ Photo ID  โ Video Call  โ Security Questions   โ   โ
โ  โ Primary Approval: admin1@org.uk (30 Nov 16:00)                  โ   โ
โ  โ                                                                   โ   โ
โ  โ [View Details] [Approve as Secondary] [Reject]                   โ   โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ                                                                         โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ  โ ๐ IDENTITY VERIFICATION IN PROGRESS                            โ   โ
โ  โ Dr. Michael Brown (m.brown@hospital.uk)                         โ   โ
โ  โ Survey: Patient Feedback Q4                                      โ   โ
โ  โ Submitted: 30 Nov 2025, 10:15 โข Request ID: DEF-456-UVW         โ   โ
โ  โ                                                                   โ   โ
โ  โ Verification: โ Photo ID  โณ Video Call (scheduled 1 Dec 10:00) โ   โ
โ  โ                                                                   โ   โ
โ  โ [View Details] [View Documents] [Schedule/Reschedule Call]       โ   โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ                                                                         โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ  โ ๐ข IN TIME DELAY                                                 โ   โ
โ  โ Dr. Emma Wilson (e.wilson@clinic.uk)                            โ   โ
โ  โ Survey: Research Study 2025                                      โ   โ
โ  โ Approved: 29 Nov 2025, 16:30 โข Request ID: GHI-789-RST          โ   โ
โ  โ                                                                   โ   โ
โ  โ โฑ๏ธ Time Remaining: 18h 45m                                       โ   โ
โ  โ Recovery Available: 1 Dec 2025, 16:30                           โ   โ
โ  โ                                                                   โ   โ
โ  โ [View Details] [View Audit Trail]                                โ   โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ                                                                         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

#### Status Indicators

| Status | Color | Icon | Description |
|--------|-------|------|-------------|
| Pending Verification | Orange | ๐ | Identity verification in progress |
| Awaiting Primary | Yellow | ๐ก | Needs first admin approval |
| Awaiting Secondary | Yellow | ๐ก | Needs second admin approval |
| In Time Delay | Green | ๐ข | Approved, waiting period active |
| Ready for Execution | Blue | ๐ต | Time delay complete, ready to execute |
| Completed | Gray | โ | Recovery finished |
| Rejected | Red | โ | Request rejected |
| Cancelled | Red | โ | Cancelled by user or admin |

### 2. Request Detail View

**URL**: `/admin/recovery/<request_id>/`

**Purpose**: Full details of a single recovery request

#### Layout

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ โ Back to Dashboard                                                     โ
โ                                                                         โ
โ Recovery Request: ABC-123-XYZ                                           โ
โ Status: ๐ก AWAITING SECONDARY APPROVAL                                  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                                         โ
โ USER INFORMATION                                                        โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ โ Name:        Dr. Sarah Jones                                        โโ
โ โ Email:       s.jones@nhs.uk                                         โโ
โ โ Account:     Created 15 Jan 2024                                    โโ
โ โ Tier:        Individual                                             โโ
โ โ Organisation: NHS Trust West (if applicable)                        โโ
โ โ Last Login:  28 Nov 2025, 09:15                                     โโ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                                                                         โ
โ SURVEY INFORMATION                                                      โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ โ Survey:      Diabetes Audit 2025                                    โโ
โ โ Created:     10 Oct 2025                                            โโ
โ โ Last Access: 25 Nov 2025, 14:00                                     โโ
โ โ Records:     156 patient records                                    โโ
โ โ Encryption:  AES-256-GCM (v2)                                       โโ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                                                                         โ
โ IDENTITY VERIFICATION                                                   โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ โ โ Photo ID                                                         โโ
โ โ    Document: UK Driving Licence                                     โโ
โ โ    Submitted: 30 Nov 2025, 14:45                                    โโ
โ โ    Verified by: admin1@org.uk (30 Nov 15:00)                        โโ
โ โ    [View Document]                                                  โโ
โ โ                                                                     โโ
โ โ โ Video Verification Call                                          โโ
โ โ    Completed: 30 Nov 2025, 15:30                                    โโ
โ โ    Duration: 12 minutes                                             โโ
โ โ    Conducted by: admin1@org.uk                                      โโ
โ โ    Notes: "Face matches ID. Confirmed employment details."          โโ
โ โ    [View Recording] (if enabled)                                    โโ
โ โ                                                                     โโ
โ โ โ Security Questions                                               โโ
โ โ    Answered: 30 Nov 2025, 14:50                                     โโ
โ โ    Result: 3/3 correct                                              โโ
โ โ    [View Questions & Answers]                                       โโ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                                                                         โ
โ AUTHORIZATION STATUS                                                    โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ โ โ Primary Authorization                                            โโ
โ โ    Approved by: admin1@org.uk                                       โโ
โ โ    Date: 30 Nov 2025, 16:00                                         โโ
โ โ    Reason: "Identity verified via video call. User confirmed       โโ
โ โ             they forgot both password and recovery phrase."         โโ
โ โ                                                                     โโ
โ โ โณ Secondary Authorization                                          โโ
โ โ    Status: Awaiting approval                                        โโ
โ โ    Eligible approvers: admin2@org.uk, admin3@org.uk                 โโ
โ โ                                                                     โโ
โ โ    [Approve as Secondary] [Reject with Reason]                      โโ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                                                                         โ
โ TIME DELAY                                                              โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ โ Status: Not yet started (awaiting secondary approval)               โโ
โ โ Configured delay: 48 hours                                          โโ
โ โ User tier: Individual                                               โโ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                                                                         โ
โ AUDIT TRAIL                                                             โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ โ 30 Nov 16:00 โ admin1@org.uk โ Primary approval granted            โโ
โ โ 30 Nov 15:30 โ admin1@org.uk โ Video call completed                 โโ
โ โ 30 Nov 15:00 โ admin1@org.uk โ Photo ID verified                    โโ
โ โ 30 Nov 14:50 โ SYSTEM        โ Security questions answered (3/3)   โโ
โ โ 30 Nov 14:45 โ s.jones@nhs.ukโ Photo ID uploaded                   โโ
โ โ 30 Nov 14:30 โ s.jones@nhs.ukโ Recovery request submitted          โโ
โ โ [Load More...]                                                      โโ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                                                                         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### 3. Identity Verification Review

**URL**: `/admin/recovery/<request_id>/verification/`

**Purpose**: Review submitted identity documents

#### Document Viewer

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ Identity Document Review                                                โ
โ Request: ABC-123-XYZ โข User: Dr. Sarah Jones                           โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                                         โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  โ
โ  โ                             โ  โ VERIFICATION CHECKLIST          โ  โ
โ  โ    [Photo ID Image]         โ  โ                                 โ  โ
โ  โ                             โ  โ โก Document is government-issued โ  โ
โ  โ    UK Driving Licence       โ  โ โก Document is not expired       โ  โ
โ  โ                             โ  โ โก Photo matches account holder  โ  โ
โ  โ    [Zoom] [Rotate]          โ  โ โก Name matches account name     โ  โ
โ  โ                             โ  โ โก No signs of tampering         โ  โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  โ โก Document is clearly legible   โ  โ
โ                                    โ                                 โ  โ
โ  Submitted: 30 Nov 2025, 14:45    โ Notes:                          โ  โ
โ  File: driving_licence.jpg         โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ  โ
โ  Size: 2.4 MB                      โ โ                             โ โ  โ
โ                                    โ โ                             โ โ  โ
โ                                    โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ  โ
โ                                    โ                                 โ  โ
โ                                    โ [Mark as Verified] [Request    โ  โ
โ                                    โ  New Document]    [Flag Issue] โ  โ
โ                                    โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  โ
โ                                                                         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ โ๏ธ SECURITY: Document images are encrypted at rest and automatically   โ
โ deleted 30 days after request completion.                              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### 4. Video Verification Interface

**URL**: `/admin/recovery/<request_id>/video-call/`

**Purpose**: Conduct or review video verification calls

#### Video Call Interface

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ Video Verification Call                                                 โ
โ Request: ABC-123-XYZ โข User: Dr. Sarah Jones                           โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                                         โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ  โ                                                                   โ   โ
โ  โ                     [Video Call Window]                          โ   โ
โ  โ                                                                   โ   โ
โ  โ                    User's video feed here                        โ   โ
โ  โ                                                                   โ   โ
โ  โ                                                                   โ   โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ                                                                         โ
โ  [๐ค Mute] [๐น Camera] [๐ฑ Screen Share] [โบ๏ธ Record] [๐ End Call]      โ
โ                                                                         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ VERIFICATION CHECKLIST                                                  โ
โ                                                                         โ
โ โก User's face matches photo ID                                         โ
โ โก User can display photo ID on camera                                  โ
โ โก User confirms they initiated the recovery request                    โ
โ โก User can answer security questions verbally                          โ
โ โก User confirms current employment (if applicable)                     โ
โ                                                                         โ
โ Notes:                                                                  โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ โ Type verification notes here...                                     โโ
โ โ                                                                     โโ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                                                                         โ
โ [Complete Verification - PASS] [Complete Verification - FAIL]          โ
โ                                                                         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### 5. Dual Authorization Workflow

**URL**: `/admin/recovery/<request_id>/authorize/`

**Purpose**: Approve or reject recovery requests

#### Authorization Form

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ Authorization Required                                                  โ
โ Request: ABC-123-XYZ                                                    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                                         โ
โ You are authorizing as: SECONDARY APPROVER                             โ
โ                                                                         โ
โ Primary approver: admin1@org.uk (30 Nov 2025, 16:00)                   โ
โ Primary reason: "Identity verified via video call..."                   โ
โ                                                                         โ
โ โ๏ธ IMPORTANT: You must independently verify this request.              โ
โ Do not rely solely on the primary approver's assessment.               โ
โ                                                                         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                                         โ
โ VERIFICATION SUMMARY                                                    โ
โ โ Photo ID: UK Driving Licence (verified by admin1@org.uk)            โ
โ โ Video Call: 12 minutes (conducted by admin1@org.uk)                  โ
โ โ Security Questions: 3/3 correct                                      โ
โ                                                                         โ
โ [Review Photo ID] [View Video Recording] [View Q&A]                    โ
โ                                                                         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                                         โ
โ YOUR DECISION                                                           โ
โ                                                                         โ
โ โ APPROVE - I have independently verified this request                 โ
โ โ REJECT - I have concerns about this request                          โ
โ                                                                         โ
โ Reason (required):                                                      โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ โ Enter your reason for approval or rejection...                      โโ
โ โ                                                                     โโ
โ โ                                                                     โโ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                                                                         โ
โ โก I confirm I am not the primary approver                              โ
โ โก I confirm I have reviewed the verification evidence                  โ
โ โก I understand this action will be logged                              โ
โ                                                                         โ
โ                                          [Cancel] [Submit Decision]     โ
โ                                                                         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### 6. Time Delay Monitor

**URL**: `/admin/recovery/time-delays/`

**Purpose**: Monitor all requests in time delay period

#### Time Delay Overview

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ Time Delay Monitor                                          [Refresh]   โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                                         โ
โ Requests Currently in Time Delay: 3                                     โ
โ                                                                         โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ โ Progress โ User              โ Survey           โ Time Remaining    โโ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโคโ
โ โ โโโโโโโโโโ Dr. Emma Wilson   โ Research Study   โ 18h 45m          โโ
โ โ โโโโโโโโโโ Dr. James Smith   โ Clinic Survey    โ 32h 15m          โโ
โ โ โโโโโโโโโโ Dr. Lisa Chen     โ Patient Records  โ 44h 30m          โโ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                                                                         โ
โ READY FOR EXECUTION: 1                                                  โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ โ ๐ต Dr. Robert Taylor โ Annual Audit โ Time delay complete           โโ
โ โ    [Execute Recovery] [View Details]                                โโ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                                                                         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### 7. Audit Trail Viewer

**URL**: `/admin/recovery/audit/`

**Purpose**: View complete audit trail across all requests

#### Audit Log View

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ Audit Trail                                                [Export CSV] โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ Filters: [Date Range โผ] [Event Type โผ] [User โผ] [Admin โผ] [Search...]  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                                         โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  โ
โ โ Timestamp           โ Event                โ Actor    โ Details   โ  โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค  โ
โ โ 30 Nov 16:31:05    โ recovery_completed   โ admin1   โ ABC-123   โ  โ
โ โ 30 Nov 16:31:00    โ custodian_accessed   โ admin1   โ ABC-123   โ  โ
โ โ 30 Nov 16:30:00    โ time_delay_complete  โ SYSTEM   โ ABC-123   โ  โ
โ โ 28 Nov 16:30:00    โ time_delay_started   โ SYSTEM   โ ABC-123   โ  โ
โ โ 28 Nov 16:30:00    โ secondary_approval   โ admin2   โ ABC-123   โ  โ
โ โ 28 Nov 16:00:00    โ primary_approval     โ admin1   โ ABC-123   โ  โ
โ โ 28 Nov 15:30:00    โ video_call_complete  โ admin1   โ ABC-123   โ  โ
โ โ 28 Nov 15:00:00    โ photo_id_verified    โ admin1   โ ABC-123   โ  โ
โ โ 28 Nov 14:50:00    โ questions_answered   โ user     โ ABC-123   โ  โ
โ โ 28 Nov 14:45:00    โ photo_id_uploaded    โ user     โ ABC-123   โ  โ
โ โ 28 Nov 14:30:00    โ request_submitted    โ user     โ ABC-123   โ  โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  โ
โ                                                                         โ
โ Showing 1-11 of 156 entries                    [Previous] [1] [2] [Next]โ
โ                                                                         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### 8. Recovery Rate Monitor

**URL**: `/admin/recovery/monitoring/`

**Purpose**: Monitor recovery rates and detect anomalies

#### Monitoring Dashboard

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ Recovery Rate Monitoring                                                โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                                         โ
โ CURRENT STATUS: โ NORMAL                                               โ
โ                                                                         โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ โ Metric                    โ Current โ Threshold โ Status           โโ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโคโ
โ โ Requests (24h)            โ 2       โ โ๏ธ 5 / ๐ด 10 โ โ Normal      โโ
โ โ Recovery Rate (%)         โ 0.3%    โ โ๏ธ 1% / ๐ด 2% โ โ Normal      โโ
โ โ Failed Verifications (24h)โ 0       โ โ๏ธ 3 / ๐ด 5  โ โ Normal      โโ
โ โ User Objections (30d)     โ 0       โ โ๏ธ 1 / ๐ด 2  โ โ Normal      โโ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                                                                         โ
โ TREND (30 DAYS)                                                         โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ โ Requests                                                            โโ
โ โ 5โ                                                                  โโ
โ โ 4โ                                           โ                      โโ
โ โ 3โ          โ                                โ                      โโ
โ โ 2โ    โ     โ     โ                    โ     โ                      โโ
โ โ 1โ โ  โ  โ  โ  โ  โ  โ     โ  โ  โ     โ  โ  โ  โ                  โโ
โ โ 0โ โ  โ  โ  โ  โ  โ  โ  โ  โ  โ  โ  โ  โ  โ  โ  โ  โ               โโ
โ โ   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ โ    1  5  10    15    20    25    30                                 โโ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                                                                         โ
โ ALERTS                                                                  โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ โ No active alerts                                                    โโ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                                                                         โ
โ [Configure Thresholds] [View Alert History] [Test Alert]               โ
โ                                                                         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### 9. SIEM Integration Status

**URL**: `/admin/recovery/siem/`

**Purpose**: Monitor SIEM connection and log forwarding

#### SIEM Status Panel

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ SIEM Integration Status                                                 โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                                         โ
โ CONNECTION STATUS: โ CONNECTED                                         โ
โ                                                                         โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ โ SIEM Type:        Elasticsearch (self-hosted)                       โโ
โ โ Endpoint:         https://elasticsearch.internal:9200               โโ
โ โ Index Pattern:    checktick-audit-*                                 โโ
โ โ Last Sync:        2 minutes ago                                     โโ
โ โ Events Today:     1,234                                             โโ
โ โ Queue Depth:      0 (real-time)                                     โโ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                                                                         โ
โ RECENT SYNC HISTORY                                                     โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ โ Time            โ Events โ Status โ Latency                        โโ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโคโ
โ โ 14:28:00        โ 15     โ โ     โ 45ms                            โโ
โ โ 14:27:00        โ 8      โ โ     โ 38ms                            โโ
โ โ 14:26:00        โ 12     โ โ     โ 52ms                            โโ
โ โ 14:25:00        โ 6      โ โ     โ 41ms                            โโ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                                                                         โ
โ [Test Connection] [View Logs] [Configure]                              โ
โ                                                                         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

## Data Models

### RecoveryRequest Model

```python
class RecoveryRequest(models.Model):
    """Model for tracking recovery requests."""

    STATUS_CHOICES = [
        ('pending_verification', 'Pending Identity Verification'),
        ('verification_in_progress', 'Identity Verification In Progress'),
        ('awaiting_primary', 'Awaiting Primary Authorization'),
        ('awaiting_secondary', 'Awaiting Secondary Authorization'),
        ('in_time_delay', 'In Time Delay Period'),
        ('ready_for_execution', 'Ready for Execution'),
        ('completed', 'Completed'),
        ('rejected', 'Rejected'),
        ('cancelled', 'Cancelled'),
    ]

    id = models.UUIDField(primary_key=True, default=uuid.uuid4)
    user = models.ForeignKey(User, on_delete=models.CASCADE)
    survey = models.ForeignKey(Survey, on_delete=models.CASCADE)
    status = models.CharField(max_length=50, choices=STATUS_CHOICES)

    # Timestamps
    submitted_at = models.DateTimeField(auto_now_add=True)
    verification_completed_at = models.DateTimeField(null=True)
    approved_at = models.DateTimeField(null=True)
    time_delay_until = models.DateTimeField(null=True)
    completed_at = models.DateTimeField(null=True)

    # Authorization
    primary_approver = models.ForeignKey(User, related_name='primary_approvals', null=True)
    primary_approved_at = models.DateTimeField(null=True)
    primary_reason = models.TextField(null=True)

    secondary_approver = models.ForeignKey(User, related_name='secondary_approvals', null=True)
    secondary_approved_at = models.DateTimeField(null=True)
    secondary_reason = models.TextField(null=True)

    # Rejection/cancellation
    rejected_by = models.ForeignKey(User, related_name='rejections', null=True)
    rejected_at = models.DateTimeField(null=True)
    rejection_reason = models.TextField(null=True)

    cancelled_by = models.ForeignKey(User, related_name='cancellations', null=True)
    cancelled_at = models.DateTimeField(null=True)
    cancellation_reason = models.TextField(null=True)

    # Execution
    executed_by = models.ForeignKey(User, related_name='executions', null=True)
    custodian_component_used = models.BooleanField(default=False)


class IdentityVerification(models.Model):
    """Model for identity verification documents and results."""

    VERIFICATION_TYPES = [
        ('photo_id', 'Photo ID'),
        ('video_call', 'Video Verification Call'),
        ('security_questions', 'Security Questions'),
        ('employment_verification', 'Employment Verification'),
    ]

    STATUS_CHOICES = [
        ('pending', 'Pending'),
        ('submitted', 'Submitted'),
        ('verified', 'Verified'),
        ('rejected', 'Rejected'),
    ]

    recovery_request = models.ForeignKey(RecoveryRequest, on_delete=models.CASCADE)
    verification_type = models.CharField(max_length=50, choices=VERIFICATION_TYPES)
    status = models.CharField(max_length=20, choices=STATUS_CHOICES)

    # Document storage (encrypted)
    document_path = models.CharField(max_length=500, null=True)

    # Verification details
    submitted_at = models.DateTimeField(null=True)
    verified_by = models.ForeignKey(User, null=True)
    verified_at = models.DateTimeField(null=True)
    verification_notes = models.TextField(null=True)

    # For security questions
    questions_asked = models.JSONField(null=True)
    correct_answers = models.IntegerField(null=True)
    total_questions = models.IntegerField(null=True)


class RecoveryAuditEntry(models.Model):
    """Immutable audit trail for recovery actions."""

    id = models.UUIDField(primary_key=True, default=uuid.uuid4)
    recovery_request = models.ForeignKey(RecoveryRequest, on_delete=models.CASCADE)

    timestamp = models.DateTimeField(auto_now_add=True)
    event_type = models.CharField(max_length=100)
    severity = models.CharField(max_length=20)

    actor_type = models.CharField(max_length=20)  # user, admin, system
    actor_id = models.IntegerField(null=True)
    actor_email = models.EmailField(null=True)
    actor_ip = models.GenericIPAddressField(null=True)

    details = models.JSONField()

    # Hash for tamper detection
    entry_hash = models.CharField(max_length=64)
    previous_hash = models.CharField(max_length=64, null=True)

    class Meta:
        ordering = ['-timestamp']
        # Prevent deletion
        managed = True
```

## API Endpoints

### Recovery Request Endpoints

```python
# GET /api/admin/recovery/
# List all recovery requests (filtered by user's scope)

# GET /api/admin/recovery/<request_id>/
# Get single recovery request details

# POST /api/admin/recovery/<request_id>/verify/
# Submit verification result (photo_id, video_call, etc.)

# POST /api/admin/recovery/<request_id>/authorize/
# Submit authorization decision (approve/reject)

# POST /api/admin/recovery/<request_id>/execute/
# Execute recovery (after time delay)

# DELETE /api/admin/recovery/<request_id>/
# Cancel recovery request

# GET /api/admin/recovery/<request_id>/audit/
# Get audit trail for request

# GET /api/admin/recovery/monitoring/
# Get recovery rate monitoring data

# GET /api/admin/recovery/siem/status/
# Get SIEM integration status
```

## Security Considerations

### Document Storage

- All identity documents encrypted at rest (AES-256-GCM)
- Documents stored in separate encrypted storage (not database)
- Automatic deletion 30 days after request completion
- Access logged to audit trail

### Video Call Recording

- Recording optional (configurable per organisation)
- If enabled, recordings encrypted and stored separately
- Automatic deletion 90 days after request completion
- Access requires explicit admin action + logging

### Session Security

- Admin sessions require MFA for recovery actions
- Session timeout: 15 minutes for recovery dashboard
- Re-authentication required for authorization decisions
- All actions logged with full context

### Rate Limiting

- Max 3 recovery requests per user per 30 days
- Max 10 authorization actions per admin per hour
- Automatic lockout after 5 failed verification attempts

## Implementation Checklist

- [ ] Recovery request model and migrations
- [ ] Identity verification model and migrations
- [ ] Audit entry model (append-only)
- [ ] Dashboard views (list, detail, verification, authorization)
- [ ] API endpoints
- [ ] Email notification integration
- [ ] SIEM forwarding
- [ ] Document storage service
- [ ] Video call integration (optional)
- [ ] Rate limiting middleware
- [ ] Admin permissions
- [ ] Unit tests
- [ ] Integration tests
- [ ] Security review

## Related Documentation

- [Key Management for Administrators](/docs/key-management-for-administrators/) - Admin procedures
- [Audit Logging and Notifications](/docs/audit-logging-and-notifications/) - Logging requirements
- [Vault Integration](/docs/vault/) - Developer API
- [Business Continuity](/docs/business-continuity/) - Disaster recovery
